#!/usr/bin/env php
<?php

declare(strict_types=1);

/**
 * debug-mcp entry point
 *
 * Starts the MCP server with stdio transport for JSON-RPC communication.
 */

// Autoload dependencies
// Use the composer proxy's autoload path if available (set by vendor/bin proxy)
// Otherwise try to find the right autoloader
if (isset($GLOBALS['_composer_autoload_path'])) {
    require_once $GLOBALS['_composer_autoload_path'];
} else {
    $autoloadPaths = [
        __DIR__ . '/../../../autoload.php',  // Project autoloader (preferred)
        __DIR__ . '/../vendor/autoload.php', // Package autoloader (fallback)
    ];

    foreach ($autoloadPaths as $autoloadPath) {
        if (file_exists($autoloadPath)) {
            require_once $autoloadPath;
            break;
        }
    }
}

use Wachterjohannes\DebugMcp\Server;

// Create and run server
$server = new Server();
$server->run();
