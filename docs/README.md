# Symfony AI Mate - Local MCP Server

Symfony AI Mate is a PHP application that creates a local MCP server to enhance your AI development assistant
(JetBrains AI, Claude, GitHub Copilot, Cursor, etc.) with specific knowledge about your application and environment.

This is the core package that creates and manages your MCP server. It includes some standard tools, while framework or
project-specific tools live in their own packages.

## Usage

Install with composer:

```bash
composer require symfony/ai-mate
```

Initialize configuration:

```bash
vendor/bin/mate init
```

To run the application, run the following command. This will start an MCP server and will run until you stop it.
```
vendor/bin/mate serve
```

See how to integrate with your AI coding assistant tool in the [integration guide](integration.md).

## How to add features?

The easiest way is to create a `mate` folder next to your `src` and `tests` directories, then add a class with a method
with attribute `#[McpTool]`:

Example:

```php
<?php
// mate/MyTool.php
namespace App\Mate;

use Mcp\Capability\Attribute\McpTool;

class MyTool
{
    #[McpTool(name: 'my_tool', description: 'My custom tool')]
    public function execute(string $param): array
    {
        return ['result' => $param];
    }
}
```

More about attributes and how to configure Prompts, Resources and more can be found at the
[mcp/sdk documentation](https://github.com/modelcontextprotocol/php-sdk).

## Configuration

The configuration folder is called `.mate` and it is located in your project's root file. In the configuration folder
there are two important files `.mate/extensions.php` and `.mate/services.php`. The former lets you enable/disable
extensions and the latter allows you to configure the settings of AI Mate and its extensions.

Tip: The folder and default configuration is automatically generated by running `mate init`.

```php
<?php
// .mate/extensions.php
// This file is managed by 'mate discover'
// You can manually edit to enable/disable extensions

return [
    'vendor/package-name' => ['enabled' => true],
    'vendor/another-package' => ['enabled' => false],
];
```

```php
<?php
// .mate/services.php

// Disable specific features from extensions
mateDisableFeature('vendor/package', 'tool', 'unwanted-tool');
mateDisableFeature('vendor/package', 'resource', 'unwanted-resource');
mateDisableFeature('vendor/package', 'prompt', 'unwanted-prompt');
mateDisableFeature('vendor/package', 'resourceTemplate', 'unwanted-template');
```

### Environment Variables

Use `%env(VAR_NAME)%` syntax in service configuration to reference environment variables.

TODO rewrite this better

### Adding Third-Party Tools

1. Install the package:
   ```bash
   composer require vendor/symfony-tools
   ```

2. Discover available tools (auto-generates/updates `.mate/extensions.php`):
   ```bash
   vendor/bin/mate discover
   ```

3. Optionally disable specific extensions:
   ```php
   // .mate/extensions.php
   return [
       'vendor/symfony-tools' => ['enabled' => true],
       'vendor/unwanted-tools' => ['enabled' => false],
   ];
   ```

To create a third party extension, follow this [guide](./creating-extensions.md).

## Commands

### Init

Initialize `.mate/extensions.php` configuration file:

```bash
vendor/bin/mate init
```

### Run server

Start the MCP server:

```bash
vendor/bin/mate serve
```

### Discover MCP features

Find available MCP extensions and auto-generate `.mate/extensions.php`:

```bash
vendor/bin/mate discover
```

This command will:
- Scan your vendor directory for packages with `extra.ai-mate` configuration
- Generate or update `.mate/extensions.php` with discovered extensions
- Preserve existing enabled/disabled states for known extensions
- Default new extensions to enabled

### Clear cache

Clear the MCP server cache:

```bash
vendor/bin/mate clear-cache
```

## Security

For security, no vendor extensions are enabled by default. You must explicitly enable packages in `.mate/extensions.php`
by setting their `enabled` flag to `true`.

Local `mate/` directory is always enabled for rapid development.
